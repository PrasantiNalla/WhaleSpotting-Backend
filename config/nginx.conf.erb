daemon off;
# Heroku dynos have at least 4 cores.
worker_processes <%= ENV['NGINX_WORKERS'] || 4 %>;

events {
        use epoll;
        accept_mutex on;
        worker_connections <%= ENV['NGINX_WORKER_CONNECTIONS'] || 1024 %>;
}

http {
        gzip on;
        gzip_comp_level 2;
        gzip_min_length 512;
        gzip_proxied any; # Heroku router sends Via header

        server {
                listen <%= ENV["PORT"] %>;
                server_name _;
                keepalive_timeout 5;
                root /app/dist;
        
                location = /index.html {
                        add_header Cache-Control "no-store, no-cache";
                        try_files $uri $uri/ =404;
                }

                location / {
                        add_header 'Cache-Control' "public, max-age=3600";
                        try_files $uri $uri/ /index.html;
                }
        }
}
